# Diophantine-equation-programs-PariGP
A set of programs for working with Diophantine equations. The programs are written in [Pari/GP](https://pari.math.u-bordeaux.fr/download.html).

Для работы всех программ необходим [Pari/GP](https://pari.math.u-bordeaux.fr/download.html) версии не ниже 2.13.1.

## Содержание 
- [ABC=N.gp и ABC=N_only-answer.gp](#ABC=N)
- [cryptosystem.gp](#crypto)
- [generalizedPellDN.gp](#generalizedPellDNgp)
- [matrix_uniformity.gp](#matrix_uniformity)
- [meanNumberOfSolution.gp](#meanNumberOfSolution)
_____
----
----
<a name="ABC=N"><h2 align="center">ABC=N.gp и ABC=N_only-answer.gp</h2></a>
Поиск примитивных и непримитивных решений уравнения 𝐴𝑥^2 + 𝐵𝑥𝑦 + 𝐶𝑦^2 = 𝑁, где Δ = 𝐵^2 − 4𝐴𝐶 > 0, 𝐴, 𝐵, 𝐶− целые числа, а 𝑁 - целое
число, неравное 0.

Все функции файла **ABC=N.gp** выводят подробности выполнения на экран, функции из **ABC=N_only-answer.gp** выводят на экран только результат вычислений.
### Список функций:
- [ABC_N(A,B,C,N)](#ABC-N)
- [validationInputData(A,B,C)](#validationInputData(A,B,C))
- [searchTetta(A,B,C,N)](#searchTetta(A,B,C,N))
- [transformationABC(a,b,c,N)](#transformationABC(a,b,c,N))
### Описание функций:

1.  <a name="ABC-N"><h4><i>ABC_N(A,B,C,N)</i></h4></a> - находит примитивные и непримитивные решения уравнения 𝐴𝑥^2+𝐵𝑥𝑦+𝐶𝑦^2 = 𝑁, где Δ=𝐵^2−4𝐴𝐶>0, 𝐴, 𝐵, 𝐶− целые числа, а 𝑁 - целое
число, неравное 0.
    + Аргументы функции:
      + 𝐴, 𝐵, 𝐶 - целые числа.
      + 𝑁 - целое число, 𝑁 ≠ 0.
    + Возвращаемое значение - массив [𝐿𝑖𝑠𝑡1, 𝐿𝑖𝑠𝑡2], где:
      + 𝐿𝑖𝑠𝑡1 - список примитивных решений.
      + 𝐿𝑖𝑠𝑡2 - список непримитивных решений.
    ----
2. <a name="validationInputData(A,B,C)"><h4><i>validationInputData(A,B,C)</i></h4></a> - внутренняя валидация входных данных для функции ***ABC_N(A,B,C,N)***. Возвращает 1 *(true)*, если валидация пройдена, 0 *(false)*, если нет.
    ----
3. <a name="searchTetta(A,B,C,N)"><h4><i>searchTetta(A,B,C,N)</i></h4></a> - находит все 𝜃, удовлетворяющие сравнению 𝑎𝜃^2 + 𝑏𝜃 + 𝑐 ≡ 0 (mod |𝑁|).
    + Аргументы функции: 𝑎, 𝑏, 𝑐, 𝑁 - целые числа.
    + Возвращаемое значение: список подходящих 𝜃 или пустой список, если таких 𝜃 нет.
    ----
4. <a name="transformationABC(a,b,c,N)"><h4><i>transformationABC(a,b,c,N)</i></h4></a> - производит унимодулярную замену переменных, которая преобразует уравнение 𝑎𝑥^2+𝑏𝑥𝑦+𝑐𝑦^2 = 𝑁 с НОД(𝑎, 𝑁) ≠ 1 в уравнение вида 𝐴𝑋^2 + 𝐵𝑋𝑌 + 𝐶𝑌^2 = 𝑁, где НОД(𝐴, 𝑁) = 1. Замена происходит с использованием матрицы
𝑇 = (︃ 𝛼, 𝛽; 𝛾, 𝛿 )︃.
    + Аргументы функции:
      + 𝑎, 𝑏, 𝑐 - целые числа.
      + 𝑁 - целое число, 𝑁 ̸≠ 0.
    + Возвращаемое значение: массив [𝐴, 𝐵, 𝐶, 𝛼, 𝛽 , 𝛾, 𝛿], где:
      + 𝐴, 𝐵, 𝐶 - аргументы нового уравнения 𝐴𝑋2 + 𝐵𝑋𝑌 + 𝐶𝑌 2 = 𝑁.
      + 𝛼, 𝛽 , 𝛾, 𝛿 - аргументы матрицы 𝑇.

[:arrow_up:Содержание](#Содержание)
_____
----
----
<a name="crypto"><h2 align="center">cryptosystem.gp</h2></a> 
...

[:arrow_up:Содержание](#Содержание)
_____
----
----
<a name="generalizedPellDNgp"><h2 align="center">generalizedPellDN.gp</h2></a>
### Список функций:
- [period(x)](#period)
- [pell(D)](#pell)
- [generalizedPell(D,N)](#generalizedPell)
- [allCongruences(D,N)](#allCongruences)
- [allCongruencesTime(D,N)](#allCongruencesTime)

### Описание функций:
1.  <a name="period"><h4><i>period(x)</i></h4></a> - Находит длину периода цепной дроби для числа √𝑥 т.е. дроби (0+√𝑥)/1
    + Аргумент функции: x - положительное целое число, не являющееся полным квадратом.
    + Возвращаемое значение: Длина периода цепной дроби для √𝑥.
    ----
2.  <a name="pell"><h4><i>pell(D)</i></h4></a> - Выводит в консоль длину периода цепной дроби для √𝐷 и решение классического уравнения Пелля 𝑥^2−𝐷𝑦^2 = ±1. Если найдено решение уравнения 𝑥^2−𝐷𝑦^2 = −1, также выводит решение для 𝑥^2 − 𝐷𝑦^2 = 1.
    + Аргумент функции: D - положительное целое число, не являющееся полным квадратом.
    ----
3.  <a name="generalizedPell"><h4><i>generalizedPell(D,N)</i></h4></a> - Находит решение обобщенного уравнения Пелля 𝑥^2−𝐷𝑦^2 = 𝑁. Выводит количество классов примитивных решений, количество классов всех решений, представителей классов примитивный решений, представителей классов непримитивных решений.
    + Аргументы функции:
      + D - положительное целое число, не являющееся полным квадратом.
      + N - целое число.
    ----
4.  <a name="allCongruences"><h4><i>allCongruences(D,N)</i></h4></a> - Находит все решения сравнения 𝑥2 ≡ 𝐷 (mod 𝑁).
    + Аргументы функции:
      + D - целое число.
      + N - целое число.
    + Возвращаемое значение - список чисел, сравнимых с 𝐷 (mod 𝑁) или 0, если таких чисел нет.
    ----
5.  <a name="allCongruencesTime"><h4><i>allCongruencesTime(D,N)</i></h4></a> - аналогично функции [allCongruences(D,N)](#allCongruences), но еще выводит время выполнения программы в секундах.

[:arrow_up:Содержание](#Содержание)
_____
----
----
<a name="matrix_uniformity"><h2 align="center">matrix_uniformity.gp</h2></a> - работа с матрицами второго порядка, имеющими неприводимый характеристический многочлен 𝜆^2 − 𝑑.
### Список функций:
- [is_matrix_uniformity(matrixA, matrixB)](#is_matrix_uniformity)
- [matrix_similarity_classes(d, flag = 0)](#matrix_similarity_classes)
- [matrix_similarity_classes_interval_d(dStart, dEnd)](#matrix_similarity_classes_interval_d)
- [mean_count_of_classes(file_name)](#mean_count_of_classes)
- [number_of_d_with_classes(file_name)](#number_of_d_with_classes)
### Описание функций:
1.  <a name="is_matrix_uniformity"><h4><i>is_matrix_uniformity(matrixA, matrixB)</i></h4></a> - Определяет подобны ли матрицы
𝑚𝑎𝑡𝑟𝑖𝑥𝐴 и 𝑚𝑎𝑡𝑟𝑖𝑥𝐵.
    + Аргументы функции: 𝑚𝑎𝑡𝑟𝑖𝑥𝐴, 𝑚𝑎𝑡𝑟𝑖𝑥𝐵 - матрицы второго порядка, имеющие неприводимый характеристический многочлен 𝜆^2 − 𝑑.
    + Возвращаемое значение: 1 - (True) если матрицы подобны, 0 (False) - иначе.
    ----
2.  <a name="matrix_similarity_classes"><h4><i>matrix_similarity_classes(d, flag = 0)</i></h4></a> - Находит количество классов подобия матриц с характеристическим многочленом 𝜆^2 − 𝑑. Опционально выводит представителей классов подобия.
    + Аргументы функции:
      + 𝑑
      + flag - если равен 1, выводит представителей классов подобия. По умолчанию равен 0.
    + Возвращаемое значение: массив [𝑐𝑜𝑢𝑛𝑡, {𝑙𝑖𝑠𝑡}], где:
      + count - количество классов подобия.
      + list - список представителей классов подобия (опционально. При 𝑓𝑙𝑎𝑔 = 1).
    ----
3. <a name="matrix_similarity_classes_interval_d"><h4><i>matrix_similarity_classes_interval_d(dStart, dEnd)</i></h4></a> - Вычисляет количество классов подобия матриц с характеристическим многочленом 𝜆^2 − 𝑑 для всех (либо только для простых) 𝑑 на отрезке [𝑑𝑆𝑡𝑎𝑟𝑡, 𝑑𝐸𝑛𝑑]. Результат вычислений записывается в файл ***"matrix_similarity_D=\<dStart\>-\<dEnd\>.txt"*** (и в файл ***"matrix_similarity_D=\<dStart\>-\<dEnd\>_with_classes.txt"***, если выбрано сохранение представителей классов подобия).
    + Аргументы функции:
      + 𝑑𝑆𝑡𝑎𝑟𝑡 - начальное значение для 𝑑.
      + 𝑑𝐸𝑛𝑑 - конечное значение для 𝑑.
    ----
4. <a name="mean_count_of_classes"><h4><i>mean_count_of_classes(file_name)</i></h4></a>  - Вычисляет среднее число классов подобия, используя таблицу с данными о количестве классов подобия.
    + Аргументы функции: 𝑓𝑖𝑙𝑒_𝑛𝑎𝑚𝑒 - имя файла* с таблицей вида: 

        | значение 𝑑  | количество классов подобия |
        | ------------- | ------------- |

    > \* - файл, полученный в результате выполнения функции ***"[matrix_similarity_classes_interval_d(dStart, dEnd)](#matrix_similarity_classes_interval_d)"***.
    
    Результат записывается в файл ***"\<file_name\>_average_count_of_classes.txt"***

    ----
5. <a name="number_of_d_with_classes"><h4><i>number_of_d_with_classes(file_name)</i></h4></a> - Вычисляет как часто встречаются опре-
деленное количество классов в файле с таблицей вида: значение 𝑑 - количество клас-
сов подобия.
    + Аргументы функции: 𝑓𝑖𝑙𝑒_𝑛𝑎𝑚𝑒 - имя файла* с таблицей вида: 
    
        | значение 𝑑  | количество классов подобия |
        | ------------- | ------------- |
    > \* - файл, полученный в результате выполнения функции ***"[matrix_similarity_classes_interval_d(dStart, dEnd)](#matrix_similarity_classes_interval_d)"***.
    
    Результат записывается в файл ***"<file_name>_number_classes_at_d.txt"***

[:arrow_up:Содержание](#Содержание)
_____
----
----
<a name="meanNumberOfSolution"><h2 align="center">meanNumberOfSolution.gp</h2></a>
### Список функций:
- [ number_of_solution(d, min_n, max_n)](#number_of_solution)
- [number_of_solution_loop(start_d, end_d, min_n max_n, threshold, threshold_n)](#number_of_solution_loop)
- [period_loop_prime(startD, endD)](#period_loop_prime)
- [period_loop_all(startD, endD)](#period_loop_all)
- [number_of_d_with_period_length(fileName)](#number_of_d_with_period_length)
### Описание функций:
1.  <a name="number_of_solution"><h4><i> number_of_solution(d, min_n, max_n)</i></h4></a> - находит число решений обобщенного уравнения Пелля 𝑥^2 − 𝐷𝑦^2 = 𝑁 для фиксированного 𝐷 и меняющемся 𝑁 в полуинтервале [1, 𝑁𝑚𝑎𝑥).
    + Аргументы функции:
      + d - значение 𝐷 уравнения 𝑥^2 − 𝐷𝑦^2 = 𝑁.
      + min_n - максимальное значение 𝑁 на полуинтервале min_n <= N <= max_n. (min_n не может быть равное 0).
      + max_n - максимальное значение 𝑁 на полуинтервале min_n <= N <= max_n.

    Во время выполнения программы, результаты вычислений записываются в файлы:
     + \<D\>_MeanNumberOfDecisions - в данный файл для конкретного 𝐷 и min_𝑛 <= 𝑁 <= 𝑚𝑎𝑥_𝑛 записывается таблица следующего вида:
        | значение 𝑁 | среднее число примитивных решений | средне число всех решений | 
        | ------------- | ------------- | ------------- |
      + \<D\>_NumberOfClasses - в данный файл для конкретного 𝐷 и min_𝑛 <= 𝑁 <= 𝑚𝑎𝑥_𝑛 записывается таблица следующего вида:
        | значение 𝑁 | количество классов примитивных решений | количество классов всех решений | 
        | ------------- | ------------- | ------------- |
        
    Функция может производить вычисления как для всех, так и только для простых чисел D.
    
    ----
2.  <a name="number_of_solution_loop"><h4><i> number_of_solution_loop(start_d, end_d, min_n max_n, threshold, threshold_n)</i></h4></a> - находит число решений обобщенного уравнения Пелля 𝑥^2 − 𝐷𝑦^2 = 𝑁 для всех простых 𝐷 на отрезке [𝑠𝑡𝑎𝑟𝑡𝐷, 𝑒𝑛𝑑𝐷] для фиксированного 𝐷 и меняющемся 𝑁 в полуинтервале [1, 𝑁𝑚𝑎𝑥).
    + Аргументы функции:
      + start_d - начальное значение 𝐷.
      + end_d - конечное значение 𝐷.
      + min_n - максимальное значение 𝑁.
      + max_n - максимальное значение 𝑁.
      + threshold - минимальное допустимое для записи в файл значение среднего числа примитивных решений.
      + threshold_n - значение N при котором проверять 𝑡ℎ𝑟𝑒𝑠ℎ𝑜𝑙𝑑.
    
    Во время выполнения программы, результаты вычислений записываются в файлы:
    D_Means_values_<start_d>_<end_d> - один общий файл, в который
записываются значение 𝐷, среднее число примитивный решений, среднее число
всех решений. В данный файл записываются значения для тех 𝐷, среднее число
примитивных решений которых больше чем 𝑡ℎ𝑟𝑒𝑠ℎ𝑜𝑙𝑑.
      + \<D\>_MeanNumberOfDecisions - в данный файл для конкретного 𝐷 и min_𝑛 <= 𝑁 <= 𝑚𝑎𝑥_𝑛 записывается таблица следующего вида:
        | значение 𝐷  | значение 𝑁 | среднее число примитивных решений | средне число всех решений | 
        | ------------- | ------------- | ------------- | ------------- |
      + \<D\>_NumberOfClasses - в данный файл для конкретного 𝐷 и min_𝑛 <= 𝑁 <= 𝑚𝑎𝑥_𝑛 записывается таблица следующего вида:
        | значение 𝐷  | значение 𝑁 | количество классов примитивных решений | количество классов всех решений | 
        | ------------- | ------------- | ------------- | ------------- |
      Данные записываются в файл, только для тех 𝐷, среднее число решений которых при 𝑁 = 𝑡ℎ𝑟𝑒𝑠ℎ𝑜𝑙𝑑_𝑛 больше, чем 𝑡ℎ𝑟𝑒𝑠ℎ𝑜𝑙𝑑. Если нужна запись для всех 𝐷, необходимо
указать аргумент 𝑡ℎ𝑟𝑒𝑠ℎ𝑜𝑙𝑑 = 0.

    Функция может производить вычисления как для всех, так и только для простых чисел D.
    
    ----
3.  <a name="period_loop_prime"><h4><i>period_loop_prime(startD, endD)</i></h4></a> - Находит длину периода цепной дроби для √𝐷 для всех простых 𝐷 на полуинтервале [𝑠𝑡𝑎𝑟𝑡𝐷, 𝑒𝑛𝑑𝐷). 
    Результат выполнения функция записывает в файл ***"Period_length_prime\<startD\>_\<endD\>.txt"***.
    ----
4.  <a name="period_loop_all"><h4><i>period_loop_all(startD, endD)</i></h4></a> - Находит длину периода цепной дроби для √𝐷 для всех 𝐷 на полуинтервале [𝑠𝑡𝑎𝑟𝑡𝐷, 𝑒𝑛𝑑𝐷).
    Полученный результат записывается в файл ***"Period length all\<startD\> \<endD\>.txt"***.
    
    ----
5.  <a name="number_of_d_with_period_length"><h4><i>number_of_d_with_period_length(fileName)</i></h4></a> - Вычисляет количество значе-
ний 𝐷 с фиксированной длиной периода 𝑙 цепной дроби для √𝐷, проходясь по входному файлу с таблицей, содержащей два столбца: значение 𝐷 и длина периода 𝑙.
    + Аргумент функции: fileName - имя текстового файла, содержащего таблицу вида: 
        | значение 𝐷  | длина периода |
        | ------------- | ------------- |
        
        Такой файл можно получить в результате выполнения функции "[period_loop_prime(startD, endD)](#period_loop_prime)" (или "[period_loop_all(startD, endD)](#period_loop_all)").
     
     Результат выполнения функции записывается в файл ***"\<fileName\>_number_of_d_with_period_length.txt"*** в виде таблицы, у которой первый столбец, это длина периода, второй - количество чисел 𝐷 имеющих такую длину периода цепной дроби для √𝐷.
     
     Также функция разбивает результат отдельно для длин вида 𝑙 = 4𝑘+𝑖, где 𝑖 ∈ [0, 3], данные записываются в файлы:
     
        "<fileName>_number_of_d_with_period_length.txt_4k.txt"
        
        "<fileName>_number_of_d_with_period_length.txt_4k+1.txt"
        
        "<fileName>_number_of_d_with_period_length.txt_4k+2.txt"
        
        "<fileName>_number_of_d_with_period_length.txt_4k+3.txt"

[:arrow_up:Содержание](#Содержание)
